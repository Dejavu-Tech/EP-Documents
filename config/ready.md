# 准备工作

> 为了保证吃货星球微信小程序的正常运营，请务必严格按照以下章节逐条做好准备工作，否则会产生不限于小程序登录、定位、支付、退款等不可预知的错误

## 相关资质 <span id="xgzz"></span>
根据腾讯对于电商类微信小程序的要求，小程序主体必须是个体工商户或企业，个人账户无法申请

如果涉及食品经营则必须提供食品经营许可证（食品生产企业必须提供食品生产许可证），其他类型企业根据其经营相关的前置审批的资质证书，具体要求可参见小程序信息里的服务类目

## 注册公众号 <span id="zcgzh"></span>
> 注册公众号和小程序的步骤和所需资料大同小异，公众号注册后小程序可复用公众号的主体认证资料直接申请小程序，无需重复交认证费用，且具有公众号推送订阅消息功能，因此本文直推公众号的注册流程。

1.打开[微信公众平台](href="https://mp.weixin.qq.com")，右上角点击“立即注册”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com7.jpg)

2.帐号类型选择服务号

![](https://image.ch871.com/screenshot-mp.weixin.qq.com.png)

3.填写从未注册过公众平台的邮箱，点击“激活邮箱”并登录您的邮箱，查看激活邮件，填写邮箱验证码、设置密码并点击“注册”。注：此密码为公众平台登录密码，不是邮箱密码

![](https://image.ch871.com/screenshot-mp.weixin.qq.com6.png)

![](https://image.ch871.com/screenshot-mp.weixin.qq.com8.png)

4.账号类型选择服务号

![](https://image.ch871.com/screenshot-mp.weixin.qq.com10.jpg)

5.信息登记，选择国籍，主体类型公司或个体户都选择企业，企业类型再选择营业执照上的类型，填写企业名称、营业执照注册号，选择验证方式。建议选择法定代表人验证，验证通过后可以让管理员突破绑定数量的限制。不建议选择微信认证，会额外产生一笔验证费。

![](https://image.ch871.com/screenshot-mp.weixin.qq.com11.png)

![](https://image.ch871.com/screenshot-mp.weixin.qq.com9.png)

6.填写管理员信息，建议与该认证联系人保持一致，需要填写身份证，手机号验证码，及个人微信扫码认证，后续后台的登录也需要该管理员的微信扫码授权。

![](https://image.ch871.com/screenshot-mp.weixin.qq.com12.png)

7.填写公众号名称及功能介绍

![](https://image.ch871.com/screenshot-mp.weixin.qq.com14.jpg)

至此公众号注册完成并于30天内（自然日）去操作微信认证，认证通过，才算注册并认证成功，帐号才能正常使用。

![](https://image.ch871.com/screenshot-mp.weixin.qq.com15.jpg)

8.微信认证，上传营业执照并点击申请

![](https://image.ch871.com/screenshot-mp.weixin.qq.com16.png)

9.填写管理员信息，建议与该认证联系人保持一致

![](https://image.ch871.com/screenshot-mp.weixin.qq.com17.png)

10.同意协议：签署《微信公众平台认证服务协议》

![](https://image.ch871.com/screenshot-mp.weixin.qq.com18.png)

11.选择认证类型及填写认证资料

![](https://image.ch871.com/screenshot-mp.weixin.qq.com19.png)

12.上传营业执照扫描件

![](https://image.ch871.com/screenshot-mp.weixin.qq.com20.png)

13.填写主体对公银行账户信息

![](https://image.ch871.com/screenshot-mp.weixin.qq.com21.png)

14.联系人信息填写，建议同上方的管理员信息保持一致

![](https://image.ch871.com/screenshot-mp.weixin.qq.com22.png)

15.确认名称，公众号名称选择2种命名方式：基于商标命名、基于自选词汇；

![](https://image.ch871.com/screenshot-mp.weixin.qq.com23.png)

16.选择开具发票的类型

![](https://image.ch871.com/screenshot-mp.weixin.qq.com24.png)

17.支付公众号认证费

![](https://image.ch871.com/screenshot-mp.weixin.qq.com25.png)

认证费支付后一般一个工作日内会有第三方认证机构的认证人员向所填联系人来电核实认证主体信息，请保持线路通畅并务必接听，否则认证失败费用不予退回。认证成功后会有站内信和邮件通知。

## 注册小程序 <span id="zcxcx"></span>
>公众号注册认证完成后的主体认证资料可直接复用申请小程序，

1.打开[微信公众平台](href="https://mp.weixin.qq.com")并登录公众号，左侧广告与服务->小程序管理,右上角点击添加

![](https://image.ch871.com/screenshot-mp.weixin.qq.com1.png)

2.选择“快速注册并认证小程序”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com2.png)

3.公众号管理员微信扫描并确认

![](https://image.ch871.com/screenshot-mp.weixin.qq.com3.png)

4.勾选“运营者信息”和“微信认证资质”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com4.png)

5.填写从未注册过公众平台的邮箱作为小程序的登录账号，设置密码，勾选协议后提交

![](https://image.ch871.com/screenshot-mp.weixin.qq.com5.png)

6.提交后进入邮箱，点击激活邮件里的链接

![](https://image.ch871.com/screenshot-mp.weixin.qq.com26.png)

![](https://image.ch871.com/screenshot-mp.weixin.qq.com27.png)

7.激活完成后填写管理员信息，手机激活码，管理员本人微信扫码认证后点击“下一步”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com28.png)

8.填写小程序信息，名称不能和其他已认证的小程序重名，重名争议的情况只能用注册商标证书进行申诉

![](https://image.ch871.com/screenshot-mp.weixin.qq.com29.png)

9.服务类目最多添加五个，不需要把营业执照上的经营范围全部囊括，但小程序所售卖的商品和服务必须严格找准所需要的类目进行选择，大多数类目都需要相关专营的资质证书，如果急需优先调试或熟悉小程序功能可暂时选择“商家自营”->“服装/鞋/箱包”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com30.png)

吃货星球小程序具有独立商户功能，当开通独立商户时小程序主体就从“商家自营”变更成了“电商平台”的性质，此时就必须提供《增值电信业务许可证》

![](https://image.ch871.com/screenshot-mp.weixin.qq.com31.png)

> 包括但不限于《注册商标证书》和《增值电信业务许可证》等资质证书的申请和满足条件时间不少于三个月以上，请提前准备，并在小程序正式运营前及时在此处更改服务类目并上传相关证书，否则小程序上传会被拒绝，上传后的小程序会在腾讯官方不定期审核后直接强制下架！！

10.等待小程序审核完成，官方说明是3个工作日内，一般情况下1个工作日就会以邮件和公众号通知形式发送审核结果

![](https://image.ch871.com/screenshot-mp.weixin.qq.com32.png)

11.审核完成后点击左侧“设置”，右测建议修改“相关公众号”、“用户隐私保护指引”和“基础库最低版本设置”

![](https://image.ch871.com/screenshot-mp.weixin.qq.com33.png)

12.右侧相关公众号点击“修改”，页面会显示同一主体展示的公众号，勾选后确定

![](https://image.ch871.com/screenshot-mp.weixin.qq.com34.png)

13.右侧用户隐私保护指引点击“修改” -> 同意协议 -> 增加信息类型

![](https://image.ch871.com/screenshot-mp.weixin.qq.com35.png)

14.至少勾选下图三个类型并确认

![](https://image.ch871.com/screenshot-mp.weixin.qq.com37.png)

15.填写收集信息的用途（尽量照下图显示填写），存储地点选“境内”，填写邮箱、勾选承诺后确定

![](https://image.ch871.com/screenshot-mp.weixin.qq.com38.png)

16.基础库最低版本设置选择2.13.1以上即可

17.牢记下方账号信息里的小程序AppID，存储时注意区分公众号AppID和小程序AppID

![](https://image.ch871.com/screenshot-mp.weixin.qq.com39.png)

## 注册微信商户号 <span id="zcwxshh"></span>

> 微信商户号是小程序、APP、H5等场景接入微信支付的必需支付平台，详细功能请自行查阅[腾讯客服页面](https://kf.qq.com/product/wechatpaymentmerchant.html)

### 注册

打开[微信支付商户平台](https://pay.weixin.qq.com)，点击“成为商家”或“接入微信支付”

![](https://image.ch871.com/screenshot-pay.weixin.qq.com01.png)

选择“注册微信支付商户号”

![](https://image.ch871.com/screenshot-pay.weixin.qq.com02.png)

选择作为支付超级管理员的微信扫码创建申请单

![](https://image.ch871.com/screenshot-pay.weixin.qq.com03.png)

填入超级管理员实名信息，关注公众号并点击“申请注册”

![](https://image.ch871.com/screenshot-pay.weixin.qq.com04.png)

5.这里如图所示填写并上传主体营业执照信息、法人身份证、对公账户信息、客服电话、小程序AppID，选择结算规则并上传相关资质后点击下一步

![](https://image.ch871.com/screenshot-pay.weixin.qq.com05.png)

6.预览申请单内容并确认提交

![](https://image.ch871.com/screenshot-pay.weixin.qq.com06.png)

7.提交后，系统会先对资料进行3~5秒的校验

![](https://image.ch871.com/screenshot-pay.weixin.qq.com07.png)

8.若系统校验通过，页面会引导进行账户验证，请使用主体对公账户向财付通指定账户汇入指定金额

![](https://image.ch871.com/screenshot-pay.weixin.qq.com08.png)

9.账户验证通过后，即已完成申请资料提交，微信支付会在1~2个工作日内完成资料审核，并通过公众号、短信、邮件向超级管理员通知审核结果

![](https://image.ch871.com/screenshot-pay.weixin.qq.com09.png)

10.审核成功后签署协议即完成注册

### 配置证书和支付场景

1.注册完成后点击“产品中心” -> “AppID账号管理” -> “关联AppID”

![](https://image.ch871.com/screenshot-pay.weixin.qq.com10.png)

2.填写小程序的AppID，勾选协议后提交

![](https://image.ch871.com/screenshot-pay.weixin.qq.com11.png)

![](https://image.ch871.com/screenshot-pay.weixin.qq.com12.png)

3.完成后打开[微信公众平台](href="https://mp.weixin.qq.com")，登陆小程序，点击左侧“微信支付”，待关联商户号中确认与刚才注册的商户号之间的授权关系

![](https://image.ch871.com/screenshot-mp.weixin.qq.com40.png)

4.预览信息勾选协议并授权

![](https://image.ch871.com/screenshot-mp.weixin.qq.com41.png)

5.开通“JSAPI支付”

![](https://image.ch871.com/screenshot-pay.weixin.qq.com13.png)

待更新







> 购买了本软件快速部署业务的客户请略过本章以下所有内容

## 注册腾讯位置服务 <span id="zctxdtk"></span>

待更新

## 购买及配置服务器 <span id="gmjfwq"></span>

待更新

## 后台搭建及部署 <span id="htbs"></span>

本小程序后台需要服务器LNMP环境搭建(linux+Nginx + Mysql + PHP) ，配置该环境有多种方式，本文推荐宝塔可视化面板安装，便于节省服务器维护的人力

### LNMP一键安装包
网址：lnmp.org，里面介绍一些要求，功能等，进入到安装页面说明，找到相关的安装说明，运行，然后按照操作说明安装即可

### 宝塔Linux面板

> 以下操作流程以腾讯云服务器为例

1.以root权限登录服务器界面,安装宝塔面板

```
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh e3bb5f4de
```
2.记住登录端口及后缀、账户和初始密码

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com01.png)

安装完成后如没有显示登录初始信息，则输入：
```
sudo /etc/init.d/bt default
```

3.升级面板

```
curl http://download.bt.cn/install/update6.sh|bash
```

4.此时访问外网面板是打不开的，因为宝塔面板的默认端口（8888）不在服务器实例的安全组规则内，所以需要打开腾讯云安全组

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com02.png)

4.1.新建安全组

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com03.png)

4.2.点击修改规则

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com04.png)

4.3.导入入站规则

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com05.png)

下载[sg_input_rules.xlsx](https://www.bt.cn/bbs/forum.php?mod=attachment&aid=NDExOHwxZGM2MWM1YXwxNjI3MjQ0NzIxfDE0MjMxMnwxMjI5)入站规则，选择此文件导入

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com06.png)

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com07.png)

4.4.导入出站规则

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com08.png)

下载[sg_output_rules.xlsx](https://www.bt.cn/bbs/forum.php?mod=attachment&aid=NDExOXw0ODkxYjFiZHwxNjI3MjQ0NzIxfDE0MjMxMnwxMjI5)出站规则，选择此文件导入

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com09.png)

4.5.检查是否导入完整

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com10.png)

4.6.安全组关联服务器实例

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com11.png)

5.浏览器打开外网面板地址，输入面板初始账号和密码

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com12.png)

6.阅读并勾选协议后进入面板

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com13.png)

7.面板首页弹出的推荐安装套件，选择“LNMP”,并严格选择图示的版本，推荐使用快速安装

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com14.png)

8.安装完成后绑定宝塔账号

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com15.png)

9.添加后台站点

![](https://image.ch871.com/screenshot-bt.cloud.tencent.com16.png)

未完待更新


### 手工搭建环境

查看是否已安装wget
```
rpm -qa wget
```
否则安装
```
yum install wget
```
查看是否已安装编译器
```
rpm -qa gcc
```
否则安装
```
yum install gcc gcc-c++
```
安装nginx依赖包

> nginx的Rewrite模块和HTTP核心模块会使用到PCRE正则表达式语法

```
yum -y install pcre pcre-devel
```
nginx的各种模块中需要使用gzip压缩
```
yum -y install zlib zlib-devel
```
安装套接字层密码库
```
yum -y install openssl openssl-devel
```
下载nginx包并解压到/usr/local/src目录中
```
cd /usr/local/src
wget http://nginx.org/download/nginx-1.1.10.tar.gz
tar -zxvf nginx-1.1.10.tar.gz
```
编译安装到/usr/local/nginx目录中
```
cd nginx-1.1.10
./configure --prefix=/usr/local/nginx
make
make install
```
创建并设置nginx运行账号
```
groupadd nginx
useradd -M -g nginx -s /sbin/nologin nginx
cd /usr/local/nginx/conf
vim nginx.conf
```
设置user参数
```
user nginx nginx
/usr/local/nginx/sbin/nginx -t
```
启动nginx
```
/usr/local/nginx/sbin/nginx
ps -ef|grep nginx
```

访问服务器IP，出现下图说明安装成功
